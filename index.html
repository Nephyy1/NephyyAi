<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NephyyAi Chat</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        gradientStart: '#1a2a6c',
                        gradientMid: '#b21f1f',
                        gradientEnd: '#fdbb2d'
                    }
                }
            }
        }
    </script>
</head>
<body class="bg-gradient-to-br from-gradientStart via-gradientMid to-gradientEnd text-white flex flex-col h-screen">
    <header class="p-4 bg-gray-900 bg-opacity-80 text-center text-xl font-semibold shadow-lg flex items-center justify-center space-x-2">
        <img src="https://cdn-icons-png.flaticon.com/512/1041/1041916.png" alt="Chat Icon" class="w-6 h-6">
        <span>NephyyAi Chat</span>
    </header>
    <main class="flex-grow flex flex-col p-4">
        <div id="chatBox" class="flex-grow overflow-y-auto space-y-4 p-4 bg-gray-800 bg-opacity-80 rounded-lg shadow-lg max-h-[75vh]"></div>
        <div class="fixed bottom-4 left-4 right-4 flex">
            <textarea id="userInput" placeholder="Ketik pesan..." class="flex-grow p-2 bg-gray-700 bg-opacity-80 text-white rounded-lg focus:outline-none shadow-lg resize-none max-h-32 overflow-y-auto"></textarea>
            <button id="sendBtn" class="ml-2 p-3 bg-gradient-to-r from-blue-500 to-blue-700 rounded-lg shadow-lg flex items-center space-x-2 transform active:scale-95 transition border border-blue-400">
                <img src="https://cdn-icons-png.flaticon.com/512/3682/3682321.png" alt="Send Icon" class="w-5 h-5">
                <span class="font-semibold">Kirim</span>
            </button>
        </div>
    </main>
    <script>
        const chatBox = document.getElementById("chatBox");
        const userInput = document.getElementById("userInput");
        const sendBtn = document.getElementById("sendBtn");

        async function sendMessage() {
            const message = userInput.value.trim();
            if (!message) return;
            chatBox.innerHTML += `<div class="text-right flex justify-end"><p class="bg-blue-600 inline-block px-4 py-2 rounded-lg shadow-lg max-w-xs md:max-w-md break-words overflow-hidden">${message}</p></div>`;
            userInput.value = "";
            chatBox.scrollTop = chatBox.scrollHeight;

            const loadingMsg = document.createElement("div");
            loadingMsg.classList.add("text-left", "flex", "justify-start");
            loadingMsg.innerHTML = `<p class="bg-gray-700 inline-block px-4 py-2 rounded-lg shadow-lg max-w-xs md:max-w-md break-words overflow-hidden">...</p>`;
            chatBox.appendChild(loadingMsg);
            chatBox.scrollTop = chatBox.scrollHeight;

            try {
                const query = encodeURIComponent(message);
                const response = await fetch(`https://endpoint.web.id/ai/gpt-3?key=SRA-QJOOSY&query=${query}&prompt=${query}`);
                const data = await response.json();
                const reply = data.result;

                chatBox.removeChild(loadingMsg);
                chatBox.innerHTML += `<div class="text-left flex justify-start"><p class="bg-gray-700 inline-block px-4 py-2 rounded-lg shadow-lg max-w-xs md:max-w-md break-words overflow-hidden">${reply}</p></div>`;
            } catch {
                chatBox.removeChild(loadingMsg);
                chatBox.innerHTML += `<div class="text-left flex justify-start"><p class="bg-red-600 inline-block px-4 py-2 rounded-lg shadow-lg max-w-xs md:max-w-md break-words overflow-hidden">Terjadi kesalahan, coba lagi nanti.</p></div>`;
            }

            chatBox.scrollTop = chatBox.scrollHeight;
        }

        sendBtn.addEventListener("click", sendMessage);
        userInput.addEventListener("keypress", (e) => {
            if (e.key === "Enter" && !e.shiftKey) {
                e.preventDefault();
                sendMessage();
            }
        });
    </script>
</body>
</html>